
CREATE TABLE IF NOT EXISTS `profiles` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `name` VARCHAR(145) NOT NULL,
  `surname` VARCHAR(145) NOT NULL,
  `email` VARCHAR(145) NOT NULL,
  `index` TINYINT(1) NOT NULL DEFAULT 0,
  `institute` VARCHAR(245) NOT NULL,
  `year` TINYINT(1) NOT NULL,
  `group` VARCHAR(145) NOT NULL,
  `created_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `updated_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  `birthday_at` DATE NOT NULL,
  `add_info` TEXT NULL DEFAULT NULL,
  PRIMARY KEY (`id`))
ENGINE = InnoDB;



CREATE TABLE IF NOT EXISTS `students` (
  `profiles_id` INT NOT NULL,
  `login` VARCHAR(245) NOT NULL,
  `password` VARCHAR(245) NOT NULL,
  `student_num` VARCHAR(245) NOT NULL,
  INDEX `fk_students_profiles_idx` (`profiles_id` ASC),
  CONSTRAINT `fk_students_profiles`
    FOREIGN KEY (`profiles_id`)
    REFERENCES `profiles` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


CREATE TABLE IF NOT EXISTS `teachers` (
  `profiles_id` INT NOT NULL,
  `login` VARCHAR(245) NOT NULL,
  `password` VARCHAR(245) NOT NULL,
  INDEX `fk_teachers_profiles1_idx` (`profiles_id` ASC),
  CONSTRAINT `fk_teachers_profiles1`
    FOREIGN KEY (`profiles_id`)
    REFERENCES `profiles` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


CREATE TABLE IF NOT EXISTS `subjects` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `name` VARCHAR(245) NOT NULL,
  `created_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `updated_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`))
ENGINE = InnoDB;


CREATE TABLE IF NOT EXISTS `lessons` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `subjects_id` INT NOT NULL,
  `profiles_id` INT NOT NULL,
  INDEX `fk_lessons_subjects1_idx` (`subjects_id` ASC),
  PRIMARY KEY (`id`),
  INDEX `fk_lessons_profiles1_idx` (`profiles_id` ASC),
  CONSTRAINT `fk_lessons_subjects1`
    FOREIGN KEY (`subjects_id`)
    REFERENCES `subjects` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_lessons_profiles1`
    FOREIGN KEY (`profiles_id`)
    REFERENCES `profiles` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


CREATE TABLE IF NOT EXISTS `practical_works` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `lessons_id` INT NOT NULL,
  `task` TEXT NOT NULL,
  `material` TEXT NULL DEFAULT NULL,
  `created_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `updated_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  `answers` TEXT NOT NULL,
  PRIMARY KEY (`id`),
  INDEX `fk_practical_works_lessons1_idx` (`lessons_id` ASC),
  CONSTRAINT `fk_practical_works_lessons1`
    FOREIGN KEY (`lessons_id`)
    REFERENCES `lessons` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


CREATE TABLE IF NOT EXISTS `student_answers` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `profiles_id` INT NOT NULL,
  `practical_works_id` INT NOT NULL,
  `comment` TEXT NOT NULL,
  `answers` TEXT NOT NULL,
  `created_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  INDEX `fk_student_answers_profiles1_idx` (`profiles_id` ASC),
  INDEX `fk_student_answers_practical_works1_idx` (`practical_works_id` ASC),
  CONSTRAINT `fk_student_answers_profiles1`
    FOREIGN KEY (`profiles_id`)
    REFERENCES `profiles` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_student_answers_practical_works1`
    FOREIGN KEY (`practical_works_id`)
    REFERENCES `practical_works` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


CREATE TABLE IF NOT EXISTS `marks` (
  `lessons_id` INT NOT NULL,
  `profiles_id` INT NOT NULL,
  `mark` VARCHAR(145) NULL DEFAULT 'NONE',
  `correct_answers` INT NOT NULL,
  `created_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  INDEX `fk_marks_lessons1_idx` (`lessons_id` ASC),
  INDEX `fk_marks_profiles1_idx` (`profiles_id` ASC),
  CONSTRAINT `fk_marks_lessons1`
    FOREIGN KEY (`lessons_id`)
    REFERENCES `lessons` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_marks_profiles1`
    FOREIGN KEY (`profiles_id`)
    REFERENCES `profiles` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


CREATE TABLE IF NOT EXISTS `discussions` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `name` VARCHAR(245) NOT NULL,
  `profiles_id` INT NOT NULL,
  `text` TEXT NOT NULL,
  `created_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `updated_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  INDEX `fk_discussions_profiles1_idx` (`profiles_id` ASC),
  CONSTRAINT `fk_discussions_profiles1`
    FOREIGN KEY (`profiles_id`)
    REFERENCES `profiles` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


CREATE TABLE IF NOT EXISTS `messages_discussions` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `discussions_id` INT NOT NULL,
  `profiles_id` INT NOT NULL,
  `created_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `updated_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  `text` TEXT NOT NULL,
  PRIMARY KEY (`id`),
  INDEX `fk_messages_discussions_discussions1_idx` (`discussions_id` ASC),
  INDEX `fk_messages_discussions_profiles1_idx` (`profiles_id` ASC),
  CONSTRAINT `fk_messages_discussions_discussions1`
    FOREIGN KEY (`discussions_id`)
    REFERENCES `discussions` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_messages_discussions_profiles1`
    FOREIGN KEY (`profiles_id`)
    REFERENCES `profiles` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


CREATE TABLE IF NOT EXISTS `notifications` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `profiles_id` INT NOT NULL,
  `text` TEXT NOT NULL,
  `created_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  INDEX `fk_notifications_profiles1_idx` (`profiles_id` ASC),
  CONSTRAINT `fk_notifications_profiles1`
    FOREIGN KEY (`profiles_id`)
    REFERENCES `profiles` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


CREATE TABLE IF NOT EXISTS `practical_messages` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `practical_works_id` INT NOT NULL,
  `profiles_id` INT NOT NULL,
  `text` TEXT NOT NULL,
  `created_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `updated_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  INDEX `fk_practical_messages_practical_works1_idx` (`practical_works_id` ASC),
  INDEX `fk_practical_messages_profiles1_idx` (`profiles_id` ASC),
  CONSTRAINT `fk_practical_messages_practical_works1`
    FOREIGN KEY (`practical_works_id`)
    REFERENCES `practical_works` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_practical_messages_profiles1`
    FOREIGN KEY (`profiles_id`)
    REFERENCES `profiles` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;